{"version":3,"sources":["util/util.js","App.js","index.js"],"names":["computeClient","width","height","screenWidth","_height","_width","console","log","w","Math","floor","h","hitListMedias","hasInsertMedias","window","config_disableUpload","oHeight","ue","DEFAULTIMG","LOADINGIMG","getHeight","body","document","html","documentElement","max","offsetHeight","scrollHeight","clientHeight","getHasimgsOrVideo","src","frag","createElement","innerHTML","videos","querySelectorAll","imgs","video","length","parseHtmlToMedias","materials","mpTagsTool","decodeTags","sections","Array","prototype","call","element","mapMedia","i","materialId","getAttribute","style","backgroundImage","url","isVideo","tagName","replaceObj","thumbImageUrl","poster","oldstyle","mediaWH","formatHTML","parentElement","section","className","setAttribute","replaceWith","App","__UE__","selection","getStart","debounce","a","getSelectionStart","alert","screenWith","clientWidth","selectMaterialFromAlbum","SelectedMaterialType","IMAGE","__nativeHtml5","getHTML","selectedMaterialList","errorMsg","ossURL","ossCover","progress","mediaId","id","_media","dataW","dataH","dataRatio","mainwidth","mainheight","hasInsert","target","getElementById","UE","dom","domUtils","setAttributes","parentNode","queryCommandState","resolve","execCommand","oldtarget","maininsert","removeAttributes","contenteditable","class","push","VIDEO","param","previewMaterial","err","resizeContainer","screen","availHeight","onRichTextEditorFocused","this","initEditor","destoryEditor","addImg","destroy","removeEventListener","handlerResize","getEditor","open_editor","pageLoad","style_width","uploadFormData","referer","referrer","initialFrameHeight","zIndex","focus","autoFloatEnabled","autoHeightEnabled","scaleEnabled","focusInEnd","elementPathEnabled","enableContextMenu","tooBars","addVideo","cancelUpLoad","shouldDelete","removeMaterialFromUploadingList","onMaterialRemove","closeEdit","setDisabled","querySelector","display","error","openEdit","setEnabled","getContent","getContentTxt","closeParagraphPop","type","s","Sys","ua","navigator","userAgent","toLowerCase","match","ie","firefox","chrome","opera","safari","e","createEvent","initEvent","dispatchEvent","click","mockClick","getMediaIds","htmlcontent","sourcedom","allvideos","getElementsByTagName","allimgs","allaudios","mediaIds","disableUpload","v","jQuery","css","_content","replaceAll","removeDeletebtn","removePlaybtn","replaceVideo","replaceImg","removeChild","newchild","removeAttribute","encodeTags","configGetContent","addEventListener","addListener","ready","getPreloadData","data","resdata","contentHTMLStr","materialList","React","Component","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.12bed74b.chunk.js","sourcesContent":["/* eslint-disable no-cond-assign */\n/* eslint-disable no-unused-expressions */\nexport const computeClient=(width,height,screenWidth)=>{\n  let _height,_width;\n  //*最高300 最宽等于屏幕宽度方案\n  // if((width<=screenWidth)&&(height<=300)){//如果图片宽度小于屏幕宽度 高度小于300则取屏幕原始宽高\t\n  //    _width=width;\n  //   _height=height;\n  // }else if((width>screenWidth)&&(height<=300)){//只有宽度大于屏幕宽度\n  //   _width=screenWidth;\t\n  //   _height=height/width*_width;\n  // }else if((height>300)&&(width<=screenWidth)){//只有高度大于300\n  //   _height=300;\n  //   _width=width/height*300;\n  //   //如果图片宽度大于屏幕宽度且高度大于300\n  // }else if((width>screenWidth)&&(height>300)){\n  //   //先按高度处理        \n  //   _height=300;\n  //   _width=width/height * 300;\n  //   //如按高度处理后宽度大于屏宽\n  //   if(_width>=screenWidth){\t\n  //     _width=screenWidth;\t\n  //     _height=height/width*_width;\n  //   }\n  // }\n\n  //* 宽度等于屏宽，高度计算\n  console.log(width,height,screenWidth)\n  _height=height*screenWidth/width;\n  _width=screenWidth;\n\n  return {w:Math.floor(_width),h:Math.floor(_height)}\n}\n\nexport const mockClick=(element)=>{\n  var Sys = {}; \n  var ua = navigator.userAgent.toLowerCase(); \n  var s; \n  (s = ua.match(/msie ([\\d.]+)/)) ? Sys.ie = s[1] : \n  (s = ua.match(/firefox\\/([\\d.]+)/)) ? Sys.firefox = s[1] : \n  (s = ua.match(/chrome\\/([\\d.]+)/)) ? Sys.chrome = s[1] : \n  (s = ua.match(/opera.([\\d.]+)/)) ? Sys.opera = s[1] : \n  (s = ua.match(/version\\/([\\d.]+).*safari/)) ? Sys.safari = s[1] : 0; \n  if (Sys.chrome || Sys.safari){\n var e = document.createEvent('MouseEvent');\n  e.initEvent('click', false, false);\n  element.dispatchEvent(e);\n }\n else{\n  element.click();\n }\n}","/***\n * APP调用h5:\n *  window.__nativeHtml5.openEdit() //开启编辑模式\n *  window.__nativeHtml5.closeEdit() //禁用编辑模式\n *  window.__nativeHtml5.getContent() //获取稿件文本\n *  window.__nativeHtml5.getHTML() //获取HTML稿件内容\n */\nimport React from 'react'\nimport {\n  selectMaterialFromAlbum,\n  SelectedMaterialType,\n  removeMaterialFromUploadingList,\n  onMaterialRemove,\n  previewMaterial,\n  getPreloadData,\n   onRichTextEditorFocused\n}\n  from \"@shuwen/app-webview\";\n  import {computeClient,mockClick} from './util/util';\n  // const getPreloadData=()=>{\n  //   return {\n  //     data:{contentHTMLStr:'请输入xx1111111111111',\n  //     placeholder:'请输入xx'}\n  //   }\n  // }\n// import fakeContent from './util/mock';\n\n//APP端必须保证一次编辑过程中列表中都是唯一的\n//本地上传的媒资进行删除时会进入黑名单防止取消后还能插入\nconst hitListMedias=[];//\n//本地已经插入完成的媒资列表,删除时要同步清除\nconst hasInsertMedias=[];\n\nwindow.config_disableUpload=false;//是否禁用上传\n//视频兜底图片\nconst DEFAULTIMG={\n  src:'https://s.newscdn.cn/file/2021/01/74b5e663-c765-4d07-a222-2cf1cbf1a9d3.png',//\n  width:200,//默认宽\n  height:200,//默认高\n}\nconst LOADINGIMG='https://s.newscdn.cn/file/2020/08/3735f261-4707-4d98-855b-fb3d79e263df.png';//加载中的默认图片\nvar oHeight;\nvar ue;\nfunction getHeight() {\n  const body = document.body;\n  const html = document.documentElement;\n  const height = Math.max(\n    body.offsetHeight,\n    body.scrollHeight,\n    html.clientHeight,\n    html.offsetHeight,\n    html.scrollHeight\n  );\n  return height;\n}\n\n//获取插入的图片/视频\nfunction getHasimgsOrVideo(src){\n  const frag = document.createElement('div');\n  frag.innerHTML = src||'';\n  const videos=frag.querySelectorAll('video')||[],\n  imgs=(frag.querySelectorAll('img')||[]);//audios=frag.querySelectorAll('audio');\n  return {\n    video:(videos||[]).length,\n    imgs:(imgs||[]).length\n  }\n}\n\n//初始化时转换为拿到的稿件内容\nfunction parseHtmlToMedias(src, materials) {\n  const frag = document.createElement('div');\n  frag.innerHTML = src||'';\n  // eslint-disable-next-line no-undef\n  mpTagsTool.decodeTags(frag,'mEditor',false);\n  const sections=(frag.querySelectorAll('section[data-media-id],foreignObject[data-media-id]')||[]);\n  Array.prototype.slice.call([...sections])\n  .forEach(element => {\n    let mapMedia = (materials || []).find(i => i.materialId === element.getAttribute('data-media-id'));\n    mapMedia&&(mapMedia.style.backgroundImage=`url(${mapMedia.url})`)\n  })\n  //处理视频和图片，音频暂不处理\n  const videos=(frag.querySelectorAll('video')||[]),imgs=(frag.querySelectorAll('img')||[]);//audios=frag.querySelectorAll('audio');\n  //处理视频和图片，音频暂不处理\n  Array.prototype.slice.call([...(videos||[]),...(imgs||[])])\n  .forEach(element => {\n      let mapMedia = (materials || []).find(i => i.materialId === element.getAttribute('data-media-id'));\n      let isVideo=element.tagName==='VIDEO';\n      //设置默认值对没媒资的进行兜底\n      let replaceObj={\n        'data-src':element.getAttribute('src'),//真实src\n        src:mapMedia?.thumbImageUrl?mapMedia.thumbImageUrl:(isVideo?(element.getAttribute('poster')||DEFAULTIMG.src):element.getAttribute('src')),//占位img标签src\n      };\n      // if(!mapMedia&&element.tagName==='IMG')return;//不需要忽略处理没有媒资信息的图片\n\n      //处理带图片的和常规的媒资\n      if(mapMedia){//对有媒资信息的进行替换\n        replaceObj['data-src'] = mapMedia?.url ||replaceObj['data-src'];//替换URL\n        isVideo&&(replaceObj.poster=replaceObj.src )//缩略图\n      }\n      // console.log('video-src',!!element.getAttribute('poster'),replaceObj.src)\n        const oldstyle=element.getAttribute('style');\n        //播放按钮样式\n      //媒资大小\n       const mediaWH='width:100%;';\n      const formatHTML='<img src=\"https://s.newscdn.cn/file/2021/02/bfb2389b-ad8d-4e7d-a73a-44f1c1b4415f.png\" onerror=\"handleCloseImageError()\" class=\"deletebtn noselect\">\\n'+\n      '<img contenteditable=\"false\" onmousedown=\"event.preventDefault(),event.cancelBubble=true;\"'+ \n      ` class=\"_editor appinsert ${isVideo?'videoimg':'appcommonimg'} noselect\"`+ \n      ` data-src=\"${replaceObj['data-src']}\"`+  \n      ` src=\"${replaceObj.src}\"`+ (isVideo?(` data-poster=\"${replaceObj.src}\"`):'')+//视频才会有\n      ` style=\"${oldstyle?oldstyle:''}${mediaWH};\"`+\n      (element.getAttribute('data-media-id')?` data-media-id=\"${element.getAttribute('data-media-id')}\"`:'')+\n      `data-oldstyle='${oldstyle}'`+\n      ` data-ratio=\"${element.getAttribute('data-ratio')}\"`+ \n      (element.getAttribute('data-w')?` data-w=\"${element.getAttribute('data-w')}\"`:'')+\n      ' controls >\\n'+\n      (isVideo?'<img src=\"https://s.newscdn.cn/file/2021/02/022d0800-4300-469c-8984-12059c7cb975.png\" contenteditable=\"false\" class=\"playbtn noselect\" >':'');\n      //如果是父亲元素是class含有_appeditor的span,则更新span的内容 如果父元素不是包含_ppeditor的span,则插入带span的固定格式\n      if(element.parentElement.tagName==='span'&&(element.parentElement.getAttribute('class').indexOf('_appeditor')>=0)){\n        element.parentElement.innerHTML=formatHTML; \n      }else{\n        var section=document.createElement('span');\n        section.style=element?.style+`;${mediaWH}`;\n        section.className=`_editor _appeditor ${isVideo?'videoimgparent':''}`;\n        section.setAttribute('contenteditable','false');\n        section.innerHTML=formatHTML;\n        element.replaceWith(section); \n      }\n    })\n  return frag.innerHTML;\n}\nclass App extends React.Component {\n  componentDidMount() {\n    this.initEditor();\n  }\n  componentWillUnmount() {\n    this.destoryEditor();\n  }\n  \n  //销毁编辑器和注册监听\n  destoryEditor() {\n    window.__UE__ && (window.__UE__ = null);\n    window.__UE__ && window.__UE__.addImg && (window.__UE__.addImg = null);\n    ue && ue.destroy();\n    ue && (ue = null);\n    window.__nativeHtml5 && (window.__nativeHtml5 = null);\n    document.removeEventListener('resize', this.handlerResize);\n  }\n  // 编辑模式初始化和监听\n  initEditor() {\n    oHeight = getHeight();\n    // @ts-ignore\n    // eslint-disable-next-line no-undef\n    window.__UE__ = UE.getEditor('container', {//\n      open_editor: false,\n      pageLoad: true,\n      // style_url: BASEURL + '/editor_styles/open?inajax=1&appkey=' + appkey,\n      // page_url: BASEURL + '/editor_styles/open_styles?inajax=1&appkey=' + appkey,\n      style_width: 600,\n      uploadFormData: {\n        referer: window.document.referrer,\n      },\n      initialFrameHeight: oHeight - 40,\n      zIndex: 1000,\n      focus: true,\n      autoFloatEnabled: false,\n      autoHeightEnabled: false,\n      scaleEnabled: false,\n      focusInEnd: true,\n      elementPathEnabled: false,\n      enableContextMenu: false,\n      tooBars: []\n    });\n    ue = window.__UE__;\n    window.__UE__.addImg = this.addImg;\n    window.__UE__.addVideo = this.addVideo;\n    window.__UE__.previewMaterial = this.previewMaterial;\n    window.__UE__.onRichTextEditorFocused=this.onRichTextEditorFocused;\n    //取消擅闯\n    window.__UE__.cancelUpLoad = async (mediaId) => {\n      hitListMedias.push(mediaId);\n      let shouldDelete=hasInsertMedias.findIndex(i=>i.mediaId===mediaId);\n      if(shouldDelete>=0){\n        hasInsertMedias.splice(shouldDelete,1);\n      }\n      await removeMaterialFromUploadingList(mediaId);\n    }\n    window.__UE__.onMaterialRemove=async(materialId)=>{\n      materialId&&onMaterialRemove&&onMaterialRemove(materialId);\n    }\n\n    //对外暴露的模块供APP调用\n    window.__nativeHtml5 = {\n      closeEdit:()=>{//禁用编辑\n        if(ue && ue.setDisabled){\n          ue.setDisabled();\n          ue.body.style.height='100vh';\n          document.querySelector('.edui-default .edui-editor-toolbarbox').style.display='none';\n          \n        }else{\n          console.error('关闭编辑模式失败')\n        }\n      },\n      openEdit:()=>{//开启编辑\n        if(ue && ue.setDisabled){\n          ue.setEnabled();\n          ue.body.style.height='calc(100% - 15px)';\n          document.querySelector('.edui-default .edui-editor-toolbarbox').style.display='block';\n          \n        }else{\n          console.error('开启编辑模式失败，或者编辑器初始化失败')\n        }\n      },\n      getContent: () => {//获取文本内容\n        const _content = (ue && ue.getContentTxt()) || '';\n        return _content||'';\n      },\n      closeParagraphPop:()=>{\n           window.closeParagraphPop({type:'23'},document.querySelector('.edui-editor-toolbarbox'));\n          mockClick(document.querySelector('.edui-editor-toolbarbox'));//只在部分浏览器上可用，最兜底使用\n      },\n      getMediaIds:()=>{\n        const htmlcontent=(ue && ue.body.innerHTML) || '';\n        var sourcedom = document.createElement('div');\n        sourcedom.innerHTML = htmlcontent;\n        let allvideos = sourcedom.getElementsByTagName('video');\n        let allimgs = sourcedom.getElementsByTagName('img');\n        let allaudios = sourcedom.getElementsByTagName('audio');\n        //获取所有带mediaId的\n        let mediaIds=[...allvideos,...allimgs,...allaudios]\n        .filter(i=>i.getAttribute('data-media-id'))\n        .map(s=>s.getAttribute('data-media-id'));\n        // console.log('medias所有的id',JSON.stringify(medias))\n        return mediaIds.length?mediaIds:[];\n      },\n      disableUpload:(v=true)=>{\n        window.config_disableUpload=v;\n        v&&window.jQuery('.edui-for-addvideo').css('opacity',0.5);\n        v&&window.jQuery('.edui-for-addimage').css('opacity',0.5);\n      },\n      getHTML: () => {//获取HTML稿件内容\n        var _content = (ue && ue.getContent()) || '';\n        if (!_content) {\n          return '';\n        }\n        _content = (_content||'').replaceAll(/(onmousedown|contenteditable)=['\"]?([^'\"]*)['\"]?/mg, '');\n        var sourcedom = document.createElement('div');\n        sourcedom.innerHTML = _content;\n        let removeDeletebtn = sourcedom.querySelectorAll('._appeditor .deletebtn');\n        let removePlaybtn = sourcedom.querySelectorAll('._appeditor .playbtn');\n        let replaceVideo = sourcedom.querySelectorAll('.videoimg');\n        let replaceImg = sourcedom.querySelectorAll('.appcommonimg');\n        [...(removeDeletebtn||[]),...(removePlaybtn||[])].forEach(i => {\n          i.parentNode.removeChild(i);\n        });\n        [...(replaceVideo||[]),...(replaceImg||[])].forEach(s=>{\n          let isVideo=(s.tagName==='VIDEO')||(s.getAttribute('class').indexOf('videoimg')>=0);\n          if (s.getAttribute('src')) {\n            let newchild = document.createElement(isVideo?'video':'img');\n             newchild.style=s.getAttribute('data-oldstyle');\n            (newchild.src = s.getAttribute(s.getAttribute('data-src')?'data-src':'src'));\n            if(isVideo){\n              if (newchild.getAttribute('style')) {\n                // ele.styles.maxWidth = '100%';\n              } else {\n                newchild.setAttribute('style', 'max-width:100%;');\n              }\n              newchild.setAttribute('preload', 'meta');\n              newchild.setAttribute('controls', 'controls');\n            }\n            // console.log('给出的链接地址',newchild.src)\n            isVideo&&s.getAttribute('data-poster') && (newchild.setAttribute('poster',s.getAttribute('data-poster')));\n            s.getAttribute('data-media-id') && (newchild.setAttribute('data-media-id', s.getAttribute('data-media-id')));\n            s.parentNode.setAttribute('class',\"_appeditor\");\n            s.parentNode.removeAttribute('style');\n            s.parentNode.replaceWith(newchild);\n          } \n        });\n          // eslint-disable-next-line no-undef\n          mpTagsTool.encodeTags(sourcedom,'mEditor',false);\n          // console.log(ue.configGetContent(sourcedom.innerHTML,true))\n        return ue.configGetContent(sourcedom.innerHTML,true);\n      },\n    }\n    //注册事件\n    document.addEventListener('resize', this.handlerResize);\n    ue.addListener('contentChange', () => {\n      // let contentLength=ue.getContentTxt()?.length;\n      // console.log('>>>>>>>getContentTxt-contentLength',contentLength)\n      // if(contentLength===0){\n      //   window.UE.dom.domUtils.addClass(ue.body,'showPlaceholder');\n      // }else{\n      //   window.UE.dom.domUtils.removeClasses(ue.body,'showPlaceholder');\n      // }\n      //  console.log('发生变化' + ue.getContentTxt());\n    });\n    ue.ready(async ()=> {\n   const {data:resdata={}} = await getPreloadData();\n  // window.UE.dom.domUtils.setAttributes(ue.body,{'data-holdtext':'请输入'})\n  // window.UE.dom.domUtils.addClass(ue.body,'showPlaceholder');\n    // const resdata={\n    //   contentHTMLStr:'<section class=\"_editor\"><p>vvbb</p><p>bbb</p><p></p></section>',\n    //   materialList: [{\n    //     \"id\": \"78267\",\n    //     \"materialId\": \"m_7c15f1b9-cd35-4768-b2e3-47edb279efc6\",\n    //     \"url\": \"https://deqing-magic-media-store.oss-cn-hangzhou.aliyuncs.com/mediaxmaterial/e7f9f0224ecf0ef5731408e100395fa4/2021/0119/image/26521f1ec05743a39e69455d7a534d88.jpg?Expires=1611100800&OSSAccessKeyId=LTAI4GDabZY3RFZ5ursYqkdy&Signature=e4A7pw3acUwNNyUMT7HBqui%2FcM4%3D\",\n    //     \"type\": \"image\",\n    //     \"thumbImageUrl\": \"https://deqing-magic-media-public.oss-cn-hangzhou.aliyuncs.com/mediaxmaterial/e7f9f0224ecf0ef5731408e100395fa4/2021/0119/thumb/ccf883bda3e2478dadfae7e0578ca23f/00001.jpg\",\n    //     \"resolutionHeight\": 350,\n    //     \"resolutionWidth\": 823,\n    //     \"title\": \"1611026156739.jpg\",\n    // },\n    // {\n    //     \"id\": \"86743\",\n    //     \"materialId\": \"m_c687226e-0f4d-450f-a135-3c5735b91c73\",\n    //     \"url\": \"https://deqing-magic-media-store.oss-cn-hangzhou.aliyuncs.com/mediaxmaterial/e7f9f0224ecf0ef5731408e100395fa4/2021/0119/image/ca5bb66013d24db2bce8e4eef7ae5ce1.png?Expires=1611100800&OSSAccessKeyId=LTAI4GDabZY3RFZ5ursYqkdy&Signature=2UJktx2gm%2B63%2FQYxCfbeXII7eVI%3D\",\n    //     \"type\": \"image\",\n    //     \"thumbImageUrl\": \"https://deqing-magic-media-public.oss-cn-hangzhou.aliyuncs.com/mediaxmaterial/e7f9f0224ecf0ef5731408e100395fa4/2021/0119/thumb/cc8a885b3584411282bba12db7aa5174/00001.jpg\",\n    //     \"resolutionHeight\": 664,\n    //     \"resolutionWidth\": 500,\n    //     \"title\": \"1611026156739.jpg\",\n    // }]\n    // }\n    // console.log('<<<<<<<<<<<原生传递的contentHTMLStr:',typeof resdata.contentHTMLStr,resdata.contentHTMLStr,resdata.contentHTMLStr?.length<=0)\n    // window.UE.dom.domUtils.setAttributes(ue.body,{'data-holdtext':resdata?.placeholder||'请输入'})\n    // if(resdata.contentHTMLStr===null||resdata.contentHTMLStr?.length<=0){\n    //   // console.log('<<<<<<<<<<<原生传递的placeholder:',resdata?.placeholder)\n    //   window.UE.dom.domUtils.addClass(ue.body,'showPlaceholder');\n    // }\n    resdata.contentHTMLStr&&(ue.body.innerHTML =parseHtmlToMedias(resdata?.contentHTMLStr||'', resdata?.materialList||[]));\n    });\n  }\n  getSelectionStart=()=>{\n    return (window.__UE__&&window.__UE__.selection.getStart());\n  }\n  //上传图片\n  // eslint-disable-next-line no-undef\n  addImg = debounce(async () => {\n    if(!this.getSelectionStart){\n      alert('光标不在编辑区域，无法插入');\n      return;\n    }\n    // console.log(window.__UE__,ue)\n    if(window.config_disableUpload){return false;}\n    const screenWith=window.__UE__.document.body.clientWidth;\n    await selectMaterialFromAlbum(SelectedMaterialType.IMAGE,getHasimgsOrVideo(window.__nativeHtml5.getHTML()).imgs,async (selectedMaterialList, errorMsg) => {\n      if (selectedMaterialList?.length) {\n        // console.log('webh5>>>>>','>>>>已经拿到图片媒资，执行替换', JSON.stringify(selectedMaterialList[0]))\n        for (let i = 0; i < selectedMaterialList.length; i++) {\n          let { width, height, ossURL,ossCover, progress, mediaId } = selectedMaterialList[i];\n          //如果在黑名单中，跳出本次循环不再处理\n          if(hitListMedias.includes(selectedMaterialList[i].id)){\n            // console.log('上传的媒资已删除',hitListMedias)\n            continue;\n          }\n          if (selectedMaterialList[i].id) {\n            const _media = {\n              id: selectedMaterialList[i].id,\n              mediaId: mediaId || '',\n              dataW: width || DEFAULTIMG.width,\n              dataH: height|| DEFAULTIMG.height,\n              dataRatio: (width && height) ? (parseInt(height) / parseInt(width)) : 0.5625,\n              ossCover: ossCover || LOADINGIMG,\n              url: ossURL || LOADINGIMG,\n            }\n            const {w:mainwidth,h:mainheight}=computeClient(width,height,screenWith);\n            const hasInsert=(_media)=>hasInsertMedias.find(a=>a.mediaId===_media.mediaId&&a.id===_media.id);\n            if (!_media.mediaId) {//不存在媒资id时\n              \n              let target = ue.document.getElementById(`fake_${_media.id}`);\n              if (!!target && window.UE) {\n                target && window.UE.dom.domUtils.setAttributes(target.parentNode, {\n                  'data-loading':`加载中…… ${progress || 0}%`,\n                })\n              } else {\n                // console.log('webh5>>>>>','>>>>不存在媒资id时且非加载中',_media.id)\n                while (ue.queryCommandState('insertHtml') === -1) {\n                  await new Promise(resolve => setTimeout(resolve, 1000))\n                }\n                ue.execCommand('insertHtml', '<section class=\"_editor _uploadbox\" data-role=\"paragraph\">\\n'+\n                `<span contenteditable=\"false\" class=\"_editor _appeditor _apptempLoading\" data-role=\"paragraph\" data-loading=${`加载中…… ${progress || 0}%`} >\\n`+\n                '<img src=\"https://s.newscdn.cn/file/2021/02/bfb2389b-ad8d-4e7d-a73a-44f1c1b4415f.png\" onerror=\"handleCloseImageError()\" class=\"deletebtn noselect\" >\\n'+\n                '<img onmousedown=\"event.preventDefault(),event.cancelBubble=true;\"'+\n                `style=\"width:${mainwidth}px;height:${mainheight}px;\"\\n`+\n                `class=\"_editor appinsert noselect loading\" src=\"${_media.ossCover}\" id=${'fake_' + _media.id} data-ratio=\"${_media.dataRatio}\" data-w=\"${_media.dataW}\"/>\\n`+\n                '</span></section>');\n              }\n            } else if(!hasInsert(_media)){//已经存在媒资id且不在已插入列表\n              // console.log('webh5>>>>>','>>>>已经存在媒资id且不在已插入列表',_media.id,_media?.mediaId  )\n              let oldtarget = ue.document.getElementById(`fake_${_media.id}`);\n              let maininsert='<img src=\"https://s.newscdn.cn/file/2021/02/bfb2389b-ad8d-4e7d-a73a-44f1c1b4415f.png\" onerror=\"handleCloseImageError()\" class=\"deletebtn noselect\" >'+\n              '<img onmousedown=\"event.preventDefault(),event.cancelBubble=true;\" class=\"_editor appinsert appcommonimg noselect\" '+\n              `src=\"${_media.ossCover}\" id=\"${'fake_' + _media.id}\" data-media-id=\"${_media.mediaId}\" data-src=\"${_media.url}\" data-ratio=\"${_media.dataRatio}\" data-w=\"${_media.dataW}\"/>`;\n              // 根据情况用属性或者直接插入\n              if (oldtarget&&oldtarget.getAttribute('class')?.indexOf('loading')) {\n                // console.log('webh5>>>>>','>>>>已经存在媒资且不在已插入列表id存在临时媒资',_media.id,_media?.mediaId  )\n                oldtarget && window.UE.dom.domUtils.removeAttributes(oldtarget.parentNode,'data-loading');\n                oldtarget && window.UE.dom.domUtils.setAttributes(oldtarget.parentNode, {\n                  contenteditable:false,\n                  class:\"_editor _appeditor\",\n                  innerHTML: maininsert,\n                })\n              }else if(!oldtarget){ \n                // console.log('webh5>>>>>','>>>>已经存在媒资且不在已插入列表且不在已插入列表id存在临时媒资',_media.id,_media?.mediaId  )\n                ue.execCommand('insertHtml', `<section class=\"_editor _uploadbox\" data-role=\"paragraph\">`+\n                `<span style=\"width:${mainwidth}px;height:${mainheight}px;\" class=\"_appeditor _appeditor\" contenteditable=\"false\">\\n`+\n                `${maininsert}\\n</span></section>`);\n              }\n              hasInsertMedias.push({id:_media.id,mediaId:_media.mediaId});\n            }\n          }\n        }\n      }\n      //todo:更新上传进度\n    });\n  }, 200, true)\n  //上传视频\n  // eslint-disable-next-line no-undef\n  addVideo = debounce(async () => {\n    if(!this.getSelectionStart){\n      alert('光标不在编辑区域，无法插入');\n      return;\n    }\n    if(window.config_disableUpload){return false;}\n    const screenWith=window.__UE__.document.body.clientWidth;\n    const hasInsert=(_media)=>hasInsertMedias.find(a=>a.mediaId===_media.mediaId&&a.id===_media.id)\n    await selectMaterialFromAlbum(SelectedMaterialType.VIDEO,getHasimgsOrVideo(window.__nativeHtml5.getHTML()).video, (async (selectedMaterialList, errorMsg) => {\n      if (selectedMaterialList) {\n        // console.log('webh5>>>>>','>>>>已经拿到视频媒资，执行替换', JSON.stringify(selectedMaterialList[0]))\n        if (selectedMaterialList?.length) {\n          for (let i = 0; i < selectedMaterialList.length; i++) {\n            let { width, height, ossURL, ossCover, progress, mediaId } = selectedMaterialList[i];\n                      //如果在黑名单中，跳出本次循环不再处理\n            if(hitListMedias.includes(selectedMaterialList[i].id)){\n              continue;\n            }\n            if (selectedMaterialList[i].id) {\n              const _media = {\n                id: selectedMaterialList[i].id,\n                mediaId: mediaId || '',\n                dataW: width || DEFAULTIMG.width,\n                dataH: height|| DEFAULTIMG.height,\n                ossCover: ossCover || LOADINGIMG,\n                dataRatio: (width && height) ? (parseInt(height) / parseInt(width)) : 0.5625,\n                url: ossURL || LOADINGIMG,\n              }\n              const {w:mainwidth,h:mainheight}=computeClient(width,height,screenWith);\n              if (!_media.mediaId) {//不存在媒资id时\n                let target = ue.document.getElementById(`fake_${_media.id}`);\n                if (!!target && window.UE) {\n                  target && window.UE.dom.domUtils.setAttributes(target.parentNode, {\n                      'data-loading':`加载中…… ${progress || 0}%`,\n                  })\n                } else {\n                  while (ue.queryCommandState('insertHtml') === -1) {\n                    await new Promise(resolve => setTimeout(resolve, 1000))\n                  }\n                  ue.execCommand('insertHtml', `<section class=\"_editor _uploadbox\" data-role=\"paragraph\">\\n`+\n                  `<span class=\" _appeditor _apptempLoading\" data-loading=\"${`加载中…… ${progress || 0}%`}\" contenteditable=\"false\"`+\n                    ` style=\"width:${mainwidth}px;height:${mainheight}px;\">\\n`+\n                    `<img src=\"https://s.newscdn.cn/file/2021/02/bfb2389b-ad8d-4e7d-a73a-44f1c1b4415f.png\" onerror=\"handleCloseImageError()\" class=\"deletebtn noselect\" >\\n`+\n                    `<img onmousedown=\"event.preventDefault(),event.cancelBubble=true;\" \\n`+\n                    `    style=\"width:${mainwidth}px;height:${mainheight}px;\"\\n`+\n                    `    class=\"_editor appinsert noselect loading\" src=\"${_media.ossCover}\" id=\"${'fake_' + _media.id}\" />\\n`+\n                    `</span></section>`);\n                }\n              } else if(!hasInsert(_media)) {//已经存在媒资id\n                //主题更新或插入内容\n                let maininsert=`<img src=\"https://s.newscdn.cn/file/2021/02/bfb2389b-ad8d-4e7d-a73a-44f1c1b4415f.png\" onerror=\"handleCloseImageError()\" class=\"deletebtn noselect\" >\\n`+\n                '<img onmousedown=\"event.preventDefault(),event.cancelBubble=true;\" class=\"_editor appinsert videoimg noselect\"'+\n                  `data-src=\"${_media.url}\" data-poster=\"${_media.ossCover}\" style=\"width:${mainwidth}px;height:${mainheight}px;\"`+\n                  `src=\"${_media.ossCover}\" id=\"${'fake_' + _media.id}\"  data-ratio=\"${_media.dataRatio}\" data-w=\"${_media.dataW}\" data-media-id=\"${_media.mediaId}\" controls >\\n`+\n                `<img src=\"https://s.newscdn.cn/file/2021/02/022d0800-4300-469c-8984-12059c7cb975.png\" class=\"playbtn noselect\" style=\"top:${mainheight/2-24}px;right:${mainwidth/2-24}px;\">`;\n               \n                // console.log('>>>','插入视频',ue.document.getElementById(`fake_${_media.id}`))\n                let oldtarget = ue.document.getElementById(`fake_${_media.id}`);\n                if (oldtarget&&oldtarget.getAttribute('class')?.indexOf('loading')) {\n                  // console.log('>>>','插入视频情况1',mainwidth,mainheight,_media.url,_media.ossCover)\n                  oldtarget && window.UE.dom.domUtils.removeAttributes(oldtarget.parentNode,'data-loading');\n                  oldtarget && window.UE.dom.domUtils.setAttributes(oldtarget.parentNode, {\n                    class:\"_editor _appeditor videoimgparent\",\n                    innerHTML:maininsert \n                  });\n                }else if(!oldtarget){ \n                  // console.log('>>>','插入视频情况2',mainwidth,mainheight,_media.url,_media.ossCover)\n                  ue.execCommand('insertHtml', '<section class=\"_editor _uploadbox\" data-role=\"paragraph\">\\n'+\n                    `<span class=\"_editor _appeditor videoimgparent\" style=\"width:${mainwidth}px;height:${mainheight}px;\" contenteditable=\"false\">\\n`+\n                      `${maininsert}\\n'</span></section>`);\n                }\n                hasInsertMedias.push(_media.mediaId);\n              }\n            }\n          }\n        }\n      }\n    })\n    )\n  }, 200, true)\n  // 预览图片播放视频\n  // eslint-disable-next-line no-undef\n  previewMaterial = debounce((param) => {\n    // console.log(param,param.materialType, param.materialType === 'IMG' ? '预览图片' : '播放视频')\n    try {\n      previewMaterial(param);\n    } catch (err) { }\n  }, 300, true);\n    //自适应尺寸\n  handlerResize=()=> {\n    if (getHeight() < oHeight) {\n      setTimeout(() => {\n        this.resizeContainer(window.screen.availHeight);\n        // fadeInOut(document.querySelector('.edui-default .edui-editor-toolbarboxinner'));\n      }, 200);\n    } else {\n      // fadeInOut(document.querySelector('.edui-default .edui-editor-toolbarboxinner'), false);\n      this.resizeContainer(getHeight());\n    }\n  }\n  //重置编辑器容器高度\n  resizeContainer=(height) =>{\n    // @ts-ignore\n    // eslint-disable-next-line no-undef\n    document.querySelectorAll('.edui-editor-iframeholder.edui-default')[0].style.height = (height - 40) + 'px';\n\n  }\n  onRichTextEditorFocused=() => {\n     onRichTextEditorFocused()\n  }\n  render() {\n    return (<div id=\"container\" />)\n  }\n}\n\nexport default App;","\n\nimport \"core-js/stable\";\nimport \"regenerator-runtime/runtime\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}